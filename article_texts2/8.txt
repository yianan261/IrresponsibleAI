. Last December, a self-driving Uber was caught on camera running a red light in San Francisco, shortly after the vehicles began testing on the roads. While Uber claimed at the time that a driver was at fault, a report from The New York Times claims that the car was in error.

The New York Times cites two company employees and internal company documents that reveal that the mapping programs guiding the vehicle in question failed to recognize six traffic lights, which allowed it to roll through a red light last December.

The ride-sharing company has had a rough week after allegations of systemic sexual harassment from a former employee came to light, as well as a lawsuit from Alphabet’s Waymo claiming that Uber stole key technology for their self-driving car program.. . Continuing a week-plus of embarrassments and bad news for Uber, the New York Times on Friday reported that traffic violations by the company’s self-driving cars were caused by problems with the cars’ mapping programs, and not, as the company had previously claimed, by human error.

The news came from two anonymous employees who spoke to the Times, and from internal documents. The mapping program failed to spot not just one red light, but at least six.

Get Data Sheet, Fortune’s technology newsletter.

After video of one of the violations surfaced in December, the company not only blamed and suspended the human monitoring the system, but doubled down. The supposedly human-caused red-light violation, they said, “is why we believe so much in making the roads safer by building self-driving Ubers.”

And while running red lights was the most egregious problem with the cars, they were also unable to safely navigate bike lanes.

Worse still, the apparently flawed system was deployed against explicit demands by California state regulators that they cease operations. Uber argued that the rules simply didn’t apply to them.

Uber withdrew its self-driving cars from San Francisco a week later, after the California DMV revoked the vehicles’ registrations.

We have reached out to the company for any response to the Times’ report and will update this story as needed.. An Uber equipped to drive itself ran a red light in San Francisco’s SOMA neighborhood Wednesday morning, per a YouTube video apparently shot from a local Luxor cab and reported by The Examiner:

In the video, a Volvo XC90 SUV decked out in the sensors Uber uses to see the world plowed through the intersection roughly three seconds after the light went red, and as a pedestrian was stepping into the crosswalk. In a statement, Uber spokesperson Chelsea Kohler said the car was being operated by its human driver at the time and had no passengers aboard, and that Uber has suspended that driver while it investigates. 2

Even if it was a human at the wheel, it’s bad news on the day Uber announced it’s welcoming passengers aboard its fleet of driverless cars in the city, and that it’s doing so without filing for an autonomous testing permit with the California DMV. Declining to do that likely means Uber doesn’t have to publicly report things like crashes and “disengagements”—when the human operator takes control to make sure the car operates safely.

In a letter sent to Uber self-driving chief Anthony Levandowski on Wednesday afternoon, California DMV counsel Brian Soublet said that if Uber does not immediately confirm it will stop testing and seek a permit, the DMV will take legal action and seek an injunction. Uber did not immediately respond to a request for comment on the letter. 3

Here’s the letter:

Related Video

Science Climb Inside Uber’s Self-Driving Car—Its Next Big Disruption

The ride-sharing giant is in Pittsburgh for its latest big move: the country’s first autonomous taxi service. Select Uber users can now ride in self-driving cars, with humans at the wheel for an emergency.

1 Story updated at 19:00 on December 14 with new information. 2 Story updated at 19:11 on December 14 to include Uber’s statement that the car was being driven by a human at the time of the incident. 3 Story updated at 19:20 on December 14 to include letter from California DMV.. Uber's San Francisco trial run of its self-driving service last Tuesday is catching people's attention. Unfortunately, it might not exactly be the kind of hype that Uber hoped for. As previously noted, the ride-hailing service company's autonomous vehicle test drive in its hometown was given a red light by the California's Department of Motor Vehicles (DMV).

To make things even more interesting, Uber's self-driving cars were caught beating non-metaphorical red lights on two separate occasions — and in both instances, the vehicles seemed to be the Volvo XC90, launched the same day as Uber's test run.

Here's the video of the erring Uber captured by Charles Rotter, operations manager at traditional cab company Luxor.

According to an Uber spokesperson, “These incidents were due to human error. This is why we believe so much in making the roads safer by building self-driving Ubers. The drivers involved have been suspended while we continue to investigate.”

The incident was also witnessed by San Fransico writer and producer Annie Guas as she was travelling by a (human piloted) Lyft. She sounded off on Twitter:

Just passed a 'self-driving' Uber that lurched into the intersection on Van Ness, on a red, nearly hitting my Lyft. — Annie Gaus (@AnnieGaus) December 14, 2016

As there are no current laws governing self-driving cars in the San Fransisco area, there is little consensus on what could or would be done. When a police officer was asked about the incident she stated, “First comes technology, then comes policy. It’s going to be a matter of setting some precedents,” said officer Giselle Talkoff, adding, “The companies that are putting these vehicles on the road should have their vehicles operate with due regard to the rules of the road.”. An autonomous Uber malfunctioned while in “self-driving mode” and caused a near collision in San Francisco, according to a business owner whose account raises new safety concerns about the unregulated technology launch.

The self-driving car – which Uber introduced without permits, as part of a testing program that California has deemed illegal – accelerated into an intersection while the light was still red and while the automation technology was clearly controlling the car, said Christopher Koff, owner of local cafe AK Subs.

“It looked like the car ran the red light on its own,” Koff, 49, said of the self-driving Uber Volvo, which has a driver in the front seat who can take control when needed. Another car that had the green light had to “slam the brakes” to avoid a crash, he said.

Koff’s story, which advocacy group Consumer Watchdog shared with state officials on Tuesday, directly contradicts Uber’s public claims that red-light violations have been the result of “human error” and that the drivers, not the technology, have failed to follow traffic laws.

The new allegations – which Uber denied and which cover an incident three weeks ago – have come to light days after the corporation openly refused to adhere to California regulations, claiming that its defiance of government was an “issue of principle”.

Uber’s autonomous cars were first spotted on San Francisco streets in September, but the company formally launched a pilot program to riders last week. California officials have repeatedly said the ride-sharing corporation, which is headquartered in San Francisco, needs testing permits, noting that 20 other companies have followed protocols.

But Uber has ignored attorney general Kamala Harris’s threat of legal action, claiming it does not need permits since the vehicles have drivers monitoring and citing the cars’ “state-of-the-art” technology and “core safety capabilities”.

Koff’s account, however, suggests that the products may not be ready for the road and that safety mechanisms are insufficient.

It was around 5am local time, and Koff said he was standing 10ft away from the vehicle when he saw it stopped at a light. While the driver was talking to a passenger, who had a laptop out, the car suddenly drove forward into the red, according to Koff. The driver’s hands were not on the wheel, he added.

“He was not driving. It was in self-driving mode,” said Koff. He noted that it was foggy at the time and that there were construction trucks nearby shining yellow lights that could have possibly interfered with the technology.

It would not be the first time the computer in a self-driving vehicle made a basic error with potentially life-threatening consequences.

In May, the “autopilot sensors” on a Tesla Motors car failed to distinguish a white tractor-trailer crossing the highway against a bright sky, leading to the first known death caused by a self-driving car.

Uber also admitted to the Guardian on Monday that its San Francisco cars have a “problem” with the way they cross bike lanes, and the company’s self-driving cars in Pittsburgh have reportedly collided with other cars and driven the wrong way on a street.



Spokeswoman Chelsea Kohler declined to provide details about Koff’s claims and sent the 